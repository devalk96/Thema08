---
title: "Assignment_2"
author: "Kasper Notebomer, Susan Reefman, Sander J. Bouwman"
date: "`r Sys.Date()`"
header-includes:
   - \usepackage{longtable}
   - \usepackage{hyperref}
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction  
This research is implementing a model for the expression of glucocorticoid receptors (GR), in which down-regulation by corticosteroids is present.  

Corticosteroids are used for the treatment of many chronic inflammatory and immune diseases, including asthma. These diseases are characterized by inflammation of the airways. 

## Goal
Simulating the dynamics of glucocorticoid receptor while under the influence of glucocorticoid. Using deSolve and R according to a 2011 paper by Barnes. 

## Theory

Currently glucocorticoids are the most effective anti-inflammatory therapy for asthma but are yet relative ineffective when used for treatment of chronic obstructive pulmonary disease (COPD). The underlying mechanism is by supressing multiple inflammatory genes by reversing histone acetylation of these active genes. (2011, Barnes) Glucocorticoids diffuse across the cell membrane and can bind to glucocorticoid receptors (GR). The glucocorticoid receptors in turn homodimerize and bind to glucocorticoid response elements (GRE) in the promoter region of glucocorticoid-responsive genes and this interaction switches gene transcription on (or on occasion off). *Figure 1* shows a more in depth view of the pathway. 
  
```{r, echo=F, out.width='50%', fig.align="center", fig.cap="Source: Journal of pharmacology and experimental therapeutics vol 307, No.1"}
knitr::include_graphics('images/pathway.png')
```

Naturally these glucocorticoids are synthetised as a reaction on factors such as: 

* Low blood sugar 
* Stress 
* Trauma 

These glucocorticoids are responsible for multiple homeostatic functions such as metabolism, immune system. The primary changes which glucocorticoids cause are increasing blood sugar levels, increase of metabolism rate, slowing inflammation, lowering bone synthesis and changes in emotional state.  

The changes which glucocorticoids cause on the rate of inflammation makes this an interesting path in reducing inflammation. There are various conditions in which reducing inflammation is a desired effect such as: asthma, organ transplants and auto-immune diseases.   

Give an explanation of the model with citations of source \cite{Soertaert10} (replace this with actual source)
and formula explanation

$$\frac{\delta mRNA_{r}}{\delta t} = k_{s\_Rm} \cdot (1 - \frac{DR(N)}{IC_{50\_Rm + DR(N)}}) - k_{d\_Rm} \cdot mRNA_{r}$$

$$\frac{\delta R}{\delta t} = k_{s\_R} \cdot mRNA_{r} + R_{f} \cdot k_{re} \cdot DR(N) - k_{on} \cdot D \cdot R - k_{d\_R} \cdot R$$

$$\frac{\delta DR}{\delta t} = k_{on} \cdot D \cdot R - k_{T} \cdot DR$$

$$\frac{\delta DR(N)}{\delta t} = k_{T} \cdot DR - k_{re} \cdot DR(N)$$


# Methods

## The software model

- Describe the software tools used, as well as the libraries
- Describe the software implementation (note: code below is an example)
```{r}
library(deSolve)

parameters <- c(ks_rm = 2.90,
                IC50_rm = 26.2,
                kon = 0.00329,
                kt = 0.63,
                kre = 0.57,
                Rf = 0.49,
                kd_r = 0.0572,
                kd_rm = 0.612,
                ks_r = 3.22,
                D = 20*1000/374.471)

state <- c(MRNAr = 4.74,
           R = 267,
           DR = 0,
           DRn = 0)

Gluco <- function(t, state, parameters) {
  with(as.list(c(state, parameters)),{
    # rate of change
    dMRNAr <- ks_rm * (1 - DRn/(IC50_rm + DRn)) - kd_rm * MRNAr
    dR <- ks_r * MRNAr + Rf * kre * DRn - kon * D * R - kd_r * R
    dDR <- kon * D * R - kt * DR
    dDRn <- kt * DR - kre * DRn
    
    # return the rate of change
    list(c(dMRNAr, dR, dDR, dDRn))
  }) # end with(as.list ...
}

times <- seq(0, 48, by = 0.01)


out <- ode(y = state, times = times, func = Gluco, parms = parameters)
```

```{r, echo=F, out.width='50%', fig.align="center", fig.cap="Source: flowdiagram glucocorticoide receptor dynamica"}
knitr::include_graphics('images/model.png')
```

## Model configuration

Explain chosen initial state, parameter values and time sequence. Use tables with values as for example below
\begin{longtable}[l]{l|l|l}
\caption{Parameter Values} \\ \hline
\label{param_table}
$\textbf{Parameter}$             &$\textbf{Value}$& $\textbf{Unit}$              \\ \hline
\endhead
$k_{s\_RM}$       & 2.90            & $fmol/g \  liver/h$      \\ \hline
$IC_{50\_Rm}$     & 26.2            & $fmol/mg \ protein$     \\ \hline
$k_{on}$          & 0.00329         & $L/nmol/h$            \\ \hline
$k_{T}$           & 0.63            & $1 / h$               \\ \hline
$k_{re}$          & 0.57            & $1 / h$               \\ \hline
$Rf$              & 0.49            & $ $                   \\ \hline
$k_{d\_R}$        & 0.0572          & $1 / h$               \\ \hline
$k_{d\_Rm}$       & 0.612           & $ $                   \\ \hline
$k_{s\_r}$        & 3.22            & $ $                   \\ \hline
$D$               & 20*1000/374.471 & $nmol/L$              \\ \hline
\end{longtable}

\begin{longtable}[l]{l|l|l}
\caption{Initial Values} \\ \hline
\label{param_table}
$\textbf{Variable}$         &$\textbf{Initial Value}$& $\textbf{Unit}$      \\ \hline
\endhead
$R_{m0}$        & 4.74      & $fmol/g \ liver$        \\ \hline
$R_{0}$         & 267       & $fmol/g \ protein$      \\ \hline
$DR$            & 0         & $fmol/g \ protein$      \\ \hline
$DR(N)$         & 0         & $fmol/g \ protein$      \\ \hline
\end{longtable}


# Results
Introduction of results, how does it answer your research questions.
```{r}
#plot(out)
#code to generate figures with title, subscripts, legenda etc
par(las=1)
plot(out, xlab = "Time (h)", 
     ylab = c("Conc. (fmol/g)", "Conc. protein (fmol/mg)", "Conc. protein (fmol/mg)", "Conc. protein (fmol/mg)"), 
     main = c("Receptor mRNA (liver)", "Free receptor", "Drug-receptor complex", "Activated receptor"),
     col="purple", ylim = list(c(0,5), c(0,300), c(0,50), c(0,50)))
```

- Describe what can be seen in such way that it leads to an answer to your research questions
- Give your figures a number and a descriptive title.
- Provide correct axis labels (unit and quantity), legend and caption.
- Always refer to and discuss your figures and tables in the text - they never stand alone.


# Discussion and Conclusion
## Discussion
- Compare your results with what is expecting from the literature and discuss differences with them.
- Discuss striking and surprising results.
- Discuss weaknesses in your research and how they could be addressed.

## General conclusion and perspective
Discuss what your goal was, what the end result is and how you could continue working from here.


\begin{thebibliography}{9}

\bibitem{Soertaert10}
Soetaert, K., Petzoldt, T., and Woodrow Setzer, R.: \textit{Solving differential equations in R: package deSolve}, J. Stat. Softw., 33, 1-25, 2010.

\end{thebibliography}
