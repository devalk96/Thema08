---
title: "Assignment_2"
author: "Kasper Notebomer, Susan Reefman, Sander J. Bouwman"
date: "`r Sys.Date()`"
header-includes:
   - \usepackage{longtable}
   - \usepackage{hyperref}
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction  

This research is a detailed analysis of the dynamic model for the expression of glucocorticoids receptors \cite{Ons eigen artikel?}. The model represents the system in which multiple variables that are commonly associated with the glucocorticoid pathway.  The experimental data is going to be compared to the simulation data.   
We analyze the model by asking multiple questions in order to research if the model and experimental data is valid.  

- *Validation*

- What is the time course concentration of the activated drug-receptor complex if there is no auto-regulation of glucocorticoid receptor? 

- What is the time course of receptor and mRNA concentrations when the drug treatment is stopped? 

- What is the effect of different values of kon and kre on the receptor and mRNA dynamics? 

- What is the effect of blocked synthesis of the receptor mRNA? 

- What is the dynamic of the system when the baseline rate of production of mRNA of the receptor is increased or decreased 2 or 5 fold? 

## Goal
The goal of this project is to analyze the model, validate experimental data and simulate scenarios. We expect that the experimental data will be in line with the model.  

## Theory
The biological model consists of four variables. MRNAr is the amount of mRNA coding for receptors, R is the density of free glucocorticoid receptors in the cytosol, DR is the density of MPL-receptor complex and DR(N) is the amount of MPL-receptor complex in the nucleus. In this model D is a parameter that stands for the plasma concentration of MPL in molar.  

*Figure 1* shows a more in depth view of the pathway. 
  
```{r, echo=F, out.width='50%', fig.align="center", fig.cap="Source: Journal of pharmacology and experimental therapeutics vol 307, No.1"}
knitr::include_graphics('images/pathway.png')
```


```{r, echo=F, out.width='50%', fig.align="center", fig.cap="Flowdiagram glucocorticoide receptor dynamica [2]"}
knitr::include_graphics('images/model.png')
```

The biological model is shown if *Figure 2*. This model consist of four variables. mRNAr is the amount of mRNA coding for receptors, R is the density of free glucocorticoid repeptors in the cytosol, DR is the density of MPL-receptor complex and DR(N) is the amount of MPL-receptor complex in the nucleus. In this model D is a parameter that stands for the plasma consentration of MPL in molar. 



# Methods

## The software model


```{r, echo=F}
library(deSolve)

parameters <- c(ks_rm = 2.90,
                IC50_rm = 26.2,
                kon = 0.00329,
                kt = 0.63,
                kre = 0.57,
                Rf = 0.49,
                kd_r = 0.0572,
                kd_rm = 0.612,
                ks_r = 3.22,
                D = 20*1000/374.471)

state <- c(MRNAr = 4.74,
           R = 267,
           DR = 0,
           DRn = 0)

Gluco <- function(t, state, parameters) {
  with(as.list(c(state, parameters)),{
    # rate of change
    dMRNAr <- ks_rm * (1 - DRn/(IC50_rm + DRn)) - kd_rm * MRNAr
    dR <- ks_r * MRNAr + Rf * kre * DRn - kon * D * R - kd_r * R
    dDR <- kon * D * R - kt * DR
    dDRn <- kt * DR - kre * DRn
    
    # return the rate of change
    list(c(dMRNAr, dR, dDR, dDRn))
  }) # end with(as.list ...
}

times <- seq(0, 48, by = 0.01)


out <- ode(y = state, times = times, func = Gluco, parms = parameters)
```

## Model configuration

The parameters and initial values that were used are based on the results from the experiment with rats. In the experiments methylprednisolone was administered for 7 days under constant infusion of 0.1 or 0.3 mg drug per kg rat per hour. Concentration of the drug was measured in ng per mL, of the receptor mRNA in fmol per g liver and of the free receptor in fmol per mg protein. 
D was calculated by the following formula: 

$$\frac{{MPL-concentration}  \cdot 1000}{374.471} $$ 

The MPL concentration is the median MPL concentration from the given data. We use the median of the experimental data so that outliers have less influence on the concentration. The median MPL concentration for 0.1 dose is 14.59 ng/ml, for 0.3 dose it is 39.925 ng/ml. We assume that the MPL concentration is constant over time.  


\begin{longtable}[l]{l|l|l}
\caption{Parameter Values} \\ \hline
\label{param_table}
$\textbf{Parameter}$             &$\textbf{Value}$& $\textbf{Unit}$              \\ \hline
\endhead
$k_{s\_RM}$       & 2.90            & $fmol/g \  liver/h$      \\ \hline
$IC_{50\_Rm}$     & 26.2            & $fmol/mg \ protein$     \\ \hline
$k_{on}$          & 0.00329         & $L/nmol/h$            \\ \hline
$k_{T}$           & 0.63            & $1 / h$               \\ \hline
$k_{re}$          & 0.57            & $1 / h$               \\ \hline
$Rf$              & 0.49            & $ $                   \\ \hline
$k_{d\_R}$        & 0.0572          & $1 / h$               \\ \hline
$k_{d\_Rm}$       & 0.612           & $ $                   \\ \hline
$k_{s\_r}$        & 3.22            & $ $                   \\ \hline
$D$               & 20*1000/374.471 & $nmol/L$              \\ \hline
\end{longtable}

\begin{longtable}[l]{l|l|l}
\caption{Initial Values} \\ \hline
\label{param_table}
$\textbf{Variable}$         &$\textbf{Initial Value}$& $\textbf{Unit}$      \\ \hline
\endhead
$R_{m0}$        & 4.74      & $fmol/g \ liver$        \\ \hline
$R_{0}$         & 267       & $fmol/g \ protein$      \\ \hline
$DR$            & 0         & $fmol/g \ protein$      \\ \hline
$DR(N)$         & 0         & $fmol/g \ protein$      \\ \hline
\end{longtable}


# Results

##A

If there is no effect of drug on the synthesis of the receptor mRNA, then the synthesis of the receptor mRNA is constant. 
When the synthesis of the receptor mRNA is constant then the density of free receptor decreases first and then reaches an equilibrium over time. This is because the synthesis and is constant, so the number of free receptors is also constant.  
The time course concentration of the drug-receptor complex reaches over time an equilibrium. At time = 0 there is no complex, because there is an oversupply of free receptor the model reaches fast its optimum. After the optimum the amount of drug-receptor complex decreases and reaches an equilibrium. This is because the synthesis of receptor mRNA and the drug concentration constant. 
The time course concentration of the activated drug-receptor complex has the same curve as the time course concentration of the drug-receptor complex. Only the time frame is *somewhat later*. This is because initially a drug-receptor complex must be formed before activation can take place. 

##B

When the drug treatment is stopped the receptor mRNA synthesis is no longer suppressed. This results in a rapid increase in receptor mRNA after there is no drug present. After a period of time the amount of receptor mRNA reaches an equilibrium again.  
The amount of free receptor decreases initially but reaches an equilibrium when the synthesis and complex forming is constant. When the drug treatment is stopped, the synthesis of receptor mRNA is increasing, this is directly linked to the increase of free receptors. After a while also the number of free receptors reaches a steady state.  
The time course of (activated) drug-receptor complex is when the drug treatment is stopped shows a rapid decrease. This is because the stopped treatment causes no drug to bind to the receptor mRNA. The complex is not formed and subsequently cannot be activated. Eventually the number of drug-receptor complexes is equal to zero.  
Because there is no binding of receptor mRNA, the total receptor concentration increases over time and reaches a steady state when the synthesis and degradation of receptor mRNA is constant. 

##C
When the association rate of the receptor is higher than the rate of the model, the amount of receptor mRNA decreases less rapidly. The reverse is true when the association rate of the receptor is lower than the rate of the model. In the *figure ...* can be seen that there are differences between the difference of higher association and the model and lower association and the model. When the association rate of the receptor is lower than the model, it has more influence on the amount of receptor mRNA than when the association rate of the receptor is higher than the model.  

When the association rate of the receptor is higher, then more receptors are binding to the drug. This means that there are less free receptors available. When the association rate is lower then more receptors do not bind to the drug than the receptors that do bind which results in a low free receptor density.  

The most differences between the model and the simulations can be seen looking at the drug-receptor complexes. With a higher association rate, the number of drug-receptor complexes increases very rapidly. This is because there is in the beginning of the simulation a high concentration of free receptors and drug is available and they have a high association for binding. With a lower association rate, the binding between drug and receptors is less self-evident. Overall, when each simulation reaches a steady state the number of drug-receptor complexes does not difference greatly.  

The total receptor density between t = 0 and t = steady state difference not great when the association rate is lower. The reverse is true for when the association is higher.  


Dissociation rates 

##D
If the synthesis of the receptor was completely blocked, there would be in time only the free receptor available that are recycled. The amount of free receptor is based on k~re~. The parameter R needs to be put to zero, because there is no synthesis of new receptors. R = 0 

 
*Receptor mRNA vs time moet nog*
 
When synthesis of the receptor is completely blocked, over time, there is no free receptors available which means the density gets to zero. When no free receptors are available, no drug-receptor complexes can be formed which means the amount of (activated) complexes decreases over time. Also, the total receptor density goes to zero over time when all synthesis is stopped.  


##E
What is the dynamic of the system when the baseline rate of production of mRNA of the receptor is increased or decreased? 

In the plots *figure … * can be seen the orange and red line that implies a decrease in baseline rate of production of mRNA of the receptor. The blue lines (light blue and dark blue) are implying an increase in baseline rate of production of mRNA of the receptor.  

Overall, the differences between the simulations are minimal. The only simulation that is off from the rest is the orange one that implies that the baseline rate is 5 times smaller than the original baseline rate. A smaller baseline rate has more influence on the simulation than a higher baseline rate.  



# Discussion and Conclusion
## Conclusion 

In this research we analyzed the dynamic model for the expression of glucocorticoids receptors and multiple simulations of this model.  
If there is no effect of drug on the synthesis of the receptor mRNA, then the synthesis of the receptor mRNA is constant. 

When the association rate is higher, more free receptors bind to the drug, which results in more drug-receptor complexes and less available free receptors. When the association rate is lower, less receptors bind to the drug in comparison to the model. This means that less drug-receptor complexes are formed and more of free receptors stay available.  

## Discussion


## General conclusion and perspective



\begin{thebibliography}{9}

\bibitem{Barnes11}
Barnes, Peter J.: \textit{Glucocorticosteroids: current and future directions}, British journal of pharmacology, 163.1, 29-43, 2011.

\bibitem{Bioinf}
Feenstra, F.: \textit{Expressie van glucocorticoid receptoren}, Hanze University of Applied Science.

\end{thebibliography}

\newpage
## Apendix
### modelling  
```{r, eval=F}
library(deSolve)

parameters <- c(ks_rm = 2.90,
                IC50_rm = 26.2,
                kon = 0.00329,
                kt = 0.63,
                kre = 0.57,
                Rf = 0.49,
                kd_r = 0.0572,
                kd_rm = 0.612,
                ks_r = 3.22,
                D = 20*1000/374.471)

state <- c(MRNAr = 4.74,
           R = 267,
           DR = 0,
           DRn = 0)

Gluco <- function(t, state, parameters) {
  with(as.list(c(state, parameters)),{
    # rate of change
    dMRNAr <- ks_rm * (1 - DRn/(IC50_rm + DRn)) - kd_rm * MRNAr
    dR <- ks_r * MRNAr + Rf * kre * DRn - kon * D * R - kd_r * R
    dDR <- kon * D * R - kt * DR
    dDRn <- kt * DR - kre * DRn
    
    # return the rate of change
    list(c(dMRNAr, dR, dDR, dDRn))
  }) # end with(as.list ...
}

times <- seq(0, 48, by = 0.01)


out <- ode(y = state, times = times, func = Gluco, parms = parameters)
```
### plotting   
```{r, eval=F}
#plot(out)
#code to generate figures with title, subscripts, legenda etc
par(las=1)
plot(out, xlab = "Time (h)", 
     ylab = c("Conc. (fmol/g)",
              "Conc. protein (fmol/mg)",
              "Conc. protein (fmol/mg)",
              "Conc. protein (fmol/mg)"), 
     main = c("Receptor mRNA (liver)",
              "Free receptor",
              "Drug-receptor complex",
              "Activated receptor complex"),
     col="purple",
     ylim = list(c(0,5),
                 c(0,300),
                 c(0,50),
                 c(0,50)))
```
